<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Decodificador RSA - Descifra mensajes con clave privada">
    <meta name="author" content="Santiago de Pablo de Castro">
    <title>Decodificador - Sistema de Cifrado RSA</title>
    
    <!-- Estilos CSS -->
    <link rel="stylesheet" href="../css/styles.css">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üîì</text></svg>">
</head>
<body class="decodificador">
    
    <!-- Contenedor principal -->
    <div class="container">
        
        <!-- Encabezado -->
        <h1 class="decodificador">üîì DECODIFICADOR</h1>
        <p class="subtitle">
            Descifra mensajes usando la clave privada RSA
        </p>

        <!-- Informaci√≥n del proceso -->
        <div class="info-box">
            <strong>‚ÑπÔ∏è ¬øC√≥mo funciona?</strong>
            <p style="margin: 10px 0 0 0; line-height: 1.8;">
                Este programa descifra mensajes que fueron cifrados con una <strong>clave p√∫blica</strong>.
                Para descifrar correctamente, necesitas usar la <strong>clave privada</strong> que
                corresponde a la clave p√∫blica usada en el cifrado.
            </p>
        </div>
        
        <div class="divider"></div>
        
        <!-- Formulario de descifrado -->
        <form onsubmit="event.preventDefault(); descifrar();">
            
            <!-- Campo 1: Clave Privada -->
            <div class="input-group">
                <label for="clavePrivada">
                    <span class="emoji">1Ô∏è‚É£</span>
                    Ingresa la Clave Privada:
                </label>
                <textarea
                    id="clavePrivada"
                    class="large"
                    placeholder="-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEA...
-----END RSA PRIVATE KEY-----"
                    required
                    spellcheck="false"
                    autocomplete="off"
                ></textarea>
                <small style="display: block; margin-top: 8px; color: #666;">
                    üí° Usa la clave privada que corresponde a la clave p√∫blica del cifrado
                </small>
            </div>
            
            <!-- Campo 2: Texto Cifrado -->
            <div class="input-group">
                <label for="textoCifrado">
                    <span class="emoji">2Ô∏è‚É£</span>
                    Pega el texto cifrado:
                </label>
                <textarea 
                    id="textoCifrado" 
                    class="large"
                    placeholder="Pega aqu√≠ el texto cifrado que obtuviste del Codificador..."
                    required
                    spellcheck="false"
                ></textarea>
                <small style="display: block; margin-top: 8px; color: #666;">
                    üîê Este es el texto cifrado que gener√≥ el Codificador | 
                    üí° Presiona <kbd style="background: #eee; padding: 2px 6px; border-radius: 3px;">Ctrl</kbd> + 
                    <kbd style="background: #eee; padding: 2px 6px; border-radius: 3px;">Enter</kbd> para descifrar
                </small>
            </div>
            
            <!-- Bot√≥n de descifrado -->
            <div class="button-container">
                <button type="submit" class="decodificador">
                    üîì DESCIFRAR MENSAJE
                </button>
            </div>
            
        </form>
        
        <!-- √Årea de resultados -->
        <div id="resultado" class="resultado"></div>
        
        <!-- Informaci√≥n sobre el proceso -->
        <div style="margin-top: 30px; padding: 20px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 8px;">
            <strong style="color: #856404;">üîê Sobre la Criptograf√≠a Asim√©trica:</strong>
            <p style="margin: 10px 0 0 0; color: #856404; line-height: 1.8;">
                Este sistema utiliza <strong>criptograf√≠a asim√©trica RSA</strong>. Lo que se cifra
                con la clave p√∫blica solo puede descifrarse con su clave privada correspondiente.
                Este es el principio fundamental de RSA usado para <strong>comunicaci√≥n segura</strong> y en
                <strong>blockchain</strong> para proteger transacciones.
            </p>
        </div>
        
        <!-- Ayuda adicional -->
        <details style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
            <summary style="cursor: pointer; font-weight: 600; color: #f5576c;">
                ‚ùì ¬øNecesitas ayuda?
            </summary>
            <div style="margin-top: 15px; line-height: 1.8; color: #666;">
                <p><strong>Si el descifrado falla:</strong></p>
                <ul style="margin: 10px 0 0 20px;">
                    <li><strong>Verifica las claves:</strong> Aseg√∫rate de usar el par de claves correcto</li>
                    <li><strong>Texto cifrado completo:</strong> Copia todo el texto cifrado sin modificaciones</li>
                    <li><strong>Formato correcto:</strong> La clave privada debe incluir las l√≠neas BEGIN y END</li>
                    <li><strong>Par correspondiente:</strong> La clave privada debe corresponder a la p√∫blica usada en el cifrado</li>
                </ul>

                <p style="margin-top: 15px;"><strong>Proceso completo:</strong></p>
                <ol style="margin: 10px 0 0 20px;">
                    <li>Genera un par de claves en el <strong>Generador</strong></li>
                    <li>Cifra un mensaje con la <strong>clave p√∫blica</strong> en el <strong>Codificador</strong></li>
                    <li>Descifra el mensaje con la <strong>clave privada</strong> aqu√≠ en el <strong>Decodificador</strong></li>
                </ol>
            </div>
        </details>
        
        <!-- Navegaci√≥n -->
        <div style="margin-top: 30px; text-align: center; padding: 20px; background: #f8f9fa; border-radius: 8px;">
            <p style="margin-bottom: 15px; color: #666; font-weight: 600;">üîó Navega entre programas:</p>
            <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                <a href="../generador/index.html" style="text-decoration: none;">
                    <button class="generador" style="width: auto; padding: 10px 20px; font-size: 14px;">
                        üîë Generador de Claves
                    </button>
                </a>
                <a href="../codificador/index.html" style="text-decoration: none;">
                    <button class="codificador" style="width: auto; padding: 10px 20px; font-size: 14px;">
                        üîí Ir al Codificador
                    </button>
                </a>
            </div>
        </div>
        
        <!-- Footer -->
        <footer style="margin-top: 30px; text-align: center; color: #999; font-size: 0.9rem;">
            <p>Caso Pr√°ctico 1 - Cifrado | Blockchain - UD1</p>
            <p style="margin-top: 5px;">Santiago de Pablo de Castro - 2¬∫ CESUR M√°laga</p>
        </footer>
        
    </div>
    
    <!-- Biblioteca JSEncrypt desde CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsencrypt/3.3.2/jsencrypt.min.js"></script>
    
    <!-- Script JavaScript -->
    <script src="../js/decodificador.js"></script>
    
</body>
</html>